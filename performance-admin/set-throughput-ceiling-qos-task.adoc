---
permalink: performance-admin/set-throughput-ceiling-qos-task.html 
sidebar: sidebar 
keywords: setting, throughput, ceiling, qos 
summary: 您可以使用原則群組的「最大處理量」欄位來定義儲存物件工作負載的處理量上限（QoS Max）。您可以在建立或修改儲存物件時套用原則群組。 
---
= 利用QoS設定處理量上限
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用原則群組的「最大處理量」欄位來定義儲存物件工作負載的處理量上限（QoS Max）。您可以在建立或修改儲存物件時套用原則群組。

.您需要的是 #8217 ；需要的是什麼
* 您必須是叢集管理員、才能建立原則群組。
* 您必須是叢集管理員、才能將原則群組套用至SVM。


.關於這項工作
* 從ONTAP S得9.4開始、您可以使用非共享的QoS原則群組、來指定定義的處理量上限會個別套用至每個成員工作負載。否則、原則群組會是_shared：_指派給原則群組的工作負載總處理量不能超過指定上限。
+
將"QoS policy-group cree"命令的"-is shared=fals"設定為指定非共用原則群組。

* 您可以指定IOPS、MB/s或IOPS、MB/s等上限的處理量限制如果您同時指定IOPS和MB/s、則會強制執行先達到的限制。
+
[NOTE]
====
如果您為相同的工作負載設定上限和樓層、則只能指定上限的處理量限制（以IOPS為單位）。

====
* 受QoS限制的儲存物件必須由原則群組所屬的SVM所包含。多個原則群組可以屬於同一個SVM。
* 如果原則群組包含物件或其子物件屬於原則群組、則無法將儲存物件指派給原則群組。
* 將原則群組套用至相同類型的儲存物件、是QoS最佳實務做法。


.步驟
. 建立原則群組：
+
「QoS原則群組create -policy_group _policy_group _-vserver _svm_-max-transmity _number_of_IOPS _|MB/s|IOPS、MB/s-is-shared true|假」

+
如需完整的命令語法、請參閱手冊頁。您可以使用「QoS原則群組修改」命令來調整處理量上限。

+
下列命令會建立共用原則群組「pg-vs1（pg-vs1）”、處理量上限為5、000 IOPS：

+
[listing]
----
cluster1::> qos policy-group create -policy-group pg-vs1 -vserver vs1 -max-throughput 5000iops -is-shared true
----
+
下列命令會建立非共用原則群組「pg-VS3（pg-VS3）”、處理量上限為100 IOPS和400 kb/s..

+
[listing]
----
cluster1::> qos policy-group create -policy-group pg-vs3 -vserver vs3 -max-throughput 100iops,400KB/s -is-shared false
----
+
下列命令會建立非共用原則群組「pg-VS4（pg-VS4））、而不會限制處理量：

+
[listing]
----
cluster1::> qos policy-group create -policy-group pg-vs4 -vserver vs4 -is-shared false
----
. 將原則群組套用至SVM、檔案、磁碟區或LUN：
+
h_Storage_object_ create -vserver _Svm_-qos-police-group _policy_group _（創建-vserver _svm_-qos-police-group _policy_group）

+
如需完整的命令語法、請參閱手冊頁。您可以使用「_Storage_object_modify」命令、將不同的原則群組套用至儲存物件。

+
下列命令會將原則群組「pg-VS1」套用至SVM「VS1」：

+
[listing]
----
cluster1::> vserver create -vserver vs1 -qos-policy-group pg-vs1
----
+
下列命令會將原則群組「pg-app」套用至Volume「app1」和「app2」：

+
[listing]
----
cluster1::> volume create -vserver vs2 -volume app1 -aggregate aggr1 -qos-policy-group pg-app
----
+
[listing]
----
cluster1::> volume create -vserver vs2 -volume app2 -aggregate aggr1 -qos-policy-group pg-app
----
. 監控原則群組效能：
+
「QoS統計效能表現」

+
如需完整的命令語法、請參閱手冊頁。

+
[NOTE]
====
監控叢集的效能。請勿使用主機上的工具來監控效能。

====
+
下列命令顯示原則群組效能：

+
[listing]
----
cluster1::> qos statistics performance show
Policy Group           IOPS      Throughput   Latency
-------------------- -------- --------------- ----------
-total-                 12316       47.76MB/s  1264.00us
pg_vs1                   5008       19.56MB/s     2.45ms
_System-Best-Effort        62       13.36KB/s     4.13ms
_System-Background         30           0KB/s        0ms
----
. 監控工作負載效能：
+
「QoS統計資料工作負載效能表現」

+
如需完整的命令語法、請參閱手冊頁。

+
[NOTE]
====
監控叢集的效能。請勿使用主機上的工具來監控效能。

====
+
下列命令顯示工作負載效能：

+
[listing]
----
cluster1::> qos statistics workload performance show
Workload          ID     IOPS      Throughput    Latency
--------------- ------ -------- ---------------- ----------
-total-              -    12320        47.84MB/s  1215.00us
app1-wid7967      7967     7219        28.20MB/s   319.00us
vs1-wid12279     12279     5026        19.63MB/s     2.52ms
_USERSPACE_APPS     14       55        10.92KB/s   236.00us
_Scan_Backgro..   5688       20            0KB/s        0ms
----
+
[NOTE]
====
您可以使用「QoS統計資料工作負載延遲show」命令來檢視QoS工作負載的詳細延遲統計資料。

====

