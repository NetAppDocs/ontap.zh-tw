---
permalink: snaplock/commit-snapshot-copies-worm-concept.html 
sidebar: sidebar 
keywords: snaplock, commit, snapshot, copy, worm, snapvault, protect, snapmirror, clone, snaplock type 
summary: 您可以在SnapLock 二線儲存設備上使用「以WORM SnapVault 保護Snapshot複本」功能。您可以在SnapLock 這個景點執行所有的基本功能。SnapVault目的地磁碟區會自動以唯讀方式掛載、因此不需要明確將Snapshot複本提交至WORM、因此不支援使用SnapMirror原則在目的地磁碟區上建立排程的Snapshot複本。 
---
= 將Snapshot複本提交至保存目的地上的WORM
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以在SnapLock 二線儲存設備上使用「以WORM SnapVault 保護Snapshot複本」功能。您可以在SnapLock 這個景點執行所有的基本功能。SnapVault目的地磁碟區會自動以唯讀方式掛載、因此不需要明確將Snapshot複本提交至WORM、因此不支援使用SnapMirror原則在目的地磁碟區上建立排程的Snapshot複本。

.開始之前
* 來源叢集必須執行ONTAP 不含更新版本的版本。
* 來源與目的地集合體必須為64位元。
* 來源Volume不能SnapLock 是一個不全的Volume。
* 來源與目的地磁碟區必須在具有連接程序的SVM的連接叢集中建立。
+
如需詳細資訊、請參閱 link:https://docs.netapp.com/us-en/ontap-sm-classic/peering/index.html["叢集對等"]。

* 如果停用Volume自動擴充、則目的地Volume上的可用空間必須至少比來源Volume上的已用空間多出5%。


.關於這項工作
來源Volume可使用NetApp或非NetApp儲存設備。對於非NetApp儲存設備、您必須使用FlexArray 「功能不全的虛擬化」。


NOTE: 您無法重新命名已提交至WORM狀態的Snapshot複本。

您可以複製SnapLock 不全的資料、但無法複製SnapLock 到一個實體磁碟區上的檔案。


NOTE: SnapLock 磁碟區不支援 LUN 。只有在非 SnapLock 磁碟區上建立的 Snapshot 複本會傳輸至 SnapLock 磁碟區、以作為 SnapLock 資料保險箱關係的一部分、才能在 SnapLock 磁碟區中支援 LUN 。讀取 / 寫入 SnapLock 磁碟區不支援 LUN 。不過、 SnapMirror 來源磁碟區和包含 LUN 的目的地磁碟區都支援防竄改 Snapshot 複本。

從 ONTAP 9.13.1 開始、您可以使用建立 FlexClone 、立即在 SnapLock for SnapVault 關係的目的地 SnapLock 磁碟區上還原鎖定的 Snapshot 複本 `snaplock-type` 選項設為「 non-SnapLock 」、並在執行磁碟區複本建立作業時、將 Snapshot 複本指定為「父快照」。深入瞭解 link:https://docs.netapp.com/us-en/ontap/volumes/create-flexclone-task.html?q=volume+clone["使用 SnapLock 類型建立 FlexClone Volume"]。

對於部分組態、您應該注意下列事項：MetroCluster

* 您只能在SnapVault 同步來源的SVM之間建立「不支援」關係、而不能在同步來源SVM和同步目的地SVM之間建立「不支援」關係。
* 您可以從SnapVault 同步來源SVM上的磁碟區、建立從資料服務SVM到資料服務SVM的不一樣關係。
* 您可以從SnapVault 資料服務SVM上的磁碟區、建立一個從同步來源SVM上DP磁碟區的不同步關係。


下圖顯示初始化SnapVault 不實關係的程序：

image::../media/snapvault-steps-clustered.gif[此圖顯示初始化SnapVault 「相互關聯」的程序：識別目的地叢集,creating a destination volume,creating a policy]

.步驟
. 識別目的地叢集。
. 在目的地叢集上、安裝SnapLock 該資訊安全許可證、初始化「完成時鐘」、如果您使用ONTAP 的是早於9.10.1的版本、請建立SnapLock 一個如所述的「不中斷彙總」 xref:workflow-concept.html[流程SnapLock]。
. 在目的地叢集上、建立類型為的 SnapLock 目的地 Volume `DP` 大小與來源 Volume 相同或更大：
+
`*volume create -vserver _SVM_name_ -volume _volume_name_ -aggregate _aggregate_name_ -snaplock-type compliance|enterprise -type DP -size _size_*`

+
[NOTE]
====
從ONTAP 版本S59.10.1開始、SnapLock 相同的集合體上可以存在不含SnapLock的不含SnapLock磁碟區；因此SnapLock 、如果您使用ONTAP 的是版本S59.10.1、則不再需要建立個別的不含SnapLock的集合體。您可以使用Volume -SnapLock類型選項來指定法規遵循或Enterprise SnapLock 版的Volume類型。在不早於版本的發行版中、從Aggregate繼承了「不更新版本」、「不更新版本」或「企業版本」ONTAP ONTAP SnapLock 。不支援具有版本彈性的目的地Volume。目的地Volume的語言設定必須符合來源Volume的語言設定。

====
+
下列命令會建立 2 GB SnapLock `Compliance` Volume 命名 `dstvolB` 在中 `SVM2` 在 Aggregate 上 `node01_aggr`：

+
[listing]
----
cluster2::> volume create -vserver SVM2 -volume dstvolB -aggregate node01_aggr -snaplock-type compliance -type DP -size 2GB
----
. 在目的地叢集上、設定預設保留期間、如所述 xref:set-default-retention-period-task.adoc[設定預設保留期間]。
+
[NOTE]
====
做為保存目的地的流通量會指派預設保留期間給它。SnapLock此期間的值一開始設定SnapLock 為0年以上、而SnapLock 「不符合需求」量則設定為30年以上。每個NetApp Snapshot複本一開始就會提交此預設保留期間。如有需要、可延長保留期間。如需詳細資訊、請參閱 xref:set-retention-period-task.adoc[設定保留時間總覽]。

====
. xref:../data-protection/create-replication-relationship-task.adoc[建立新的複寫關係] 在非SnapLock來源和SnapLock 您在步驟3中建立的新的目的地之間。
+
此範例建立了與目的地 SnapLock Volume 的全新 SnapMirror 關係 `dstvolB` 使用的原則 `XDPDefault` 若要按每小時排程、將標示為每天和每週的 Snapshot 複本資料保存：

+
[listing]
----
cluster2::> snapmirror create -source-path SVM1:srcvolA -destination-path SVM2:dstvolB -vserver SVM2 -policy XDPDefault -schedule hourly
----
+
[NOTE]
====
xref:../data-protection/create-custom-replication-policy-concept.adoc[建立自訂複寫原則] 或是 xref:../data-protection/create-replication-job-schedule-task.adoc[自訂排程] 如果可用的預設值不適用。

====
. 在目的地SVM上、初始化SnapVault 步驟5中建立的S動動學 關係：
+
`*snapmirror initialize -destination-path _destination_path_*`

+
下列命令可初始化來源磁碟區之間的關係 `srcvolA` 開啟 `SVM1` 以及目的地Volume `dstvolB` 開啟 `SVM2`：

+
[listing]
----
cluster2::> snapmirror initialize -destination-path SVM2:dstvolB
----
. 在關係初始化及閒置之後、請使用 `snapshot show` 用於驗證已套用至複寫 Snapshot 複本的 SnapLock 到期時間的命令。
+
此範例列出磁碟區上的 Snapshot 複本 `dstvolB` SnapMirror 標籤和 SnapLock 到期日：

+
[listing]
----
cluster2::> snapshot show -vserver SVM2 -volume dstvolB -fields snapmirror-label, snaplock-expiry-time
----


.相關資訊
https://docs.netapp.com/us-en/ontap-sm-classic/peering/index.html["叢集與SVM對等關係"]

https://docs.netapp.com/us-en/ontap-sm-classic/volume-backup-snapvault/index.html["使用SnapVault 功能進行Volume備份"]
