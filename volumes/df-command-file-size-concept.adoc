---
permalink: volumes/df-command-file-size-concept.html 
sidebar: sidebar 
keywords: how, df command, accounts for file size 
summary: 在df命令中報告空間使用量的方式取決於兩種情況：為包含qtree的磁碟區啟用或停用配額、以及是否追蹤qtree內的配額使用量。 
---
= df命令如何計算檔案大小
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
在「df」命令中報告空間使用量的方式取決於兩種情況：包含qtree的磁碟區是否啟用或停用配額、以及是否追蹤qtree內的配額使用量。

如果對包含qtree的磁碟區啟用配額、並追蹤qtree內的配額使用量、則「df」命令所報告的空間使用量會等於配額報告所指定的值。在這種情況下、配額使用量會排除目錄、ACL、串流目錄和中繼檔所使用的區塊。

當磁碟區上未啟用配額、或qtree未設定配額規則時、報告的空間使用量會包含整個磁碟區（包括磁碟區內的其他qtree）的目錄、ACL、串流目錄和中繼檔所使用的區塊。在這種情況下、「df」命令所報告的空間使用量大於追蹤配額時所報告的預期值。

當您從追蹤配額使用量的qtree掛載點執行「df」命令時、命令輸出會顯示與配額報告指定值相同的空間使用量。在大多數情況下、當樹狀結構配額規則有硬碟限制時、「df」命令所報告的總大小等於磁碟限制、可用空間等於配額磁碟限制與配額使用量之間的差異。

但是在某些情況下、使用「df」命令所報告的可用空間、可能等於整個磁碟區的可用空間。如果沒有為qtree設定硬碟限制、就可能發生此問題。從供應到供應的更新版本9.9.1開始ONTAP 、當整個磁碟區的可用空間少於剩餘的樹狀結構配額空間時、也會發生此問題。發生上述任一情況時、「df」命令所報告的總大小是一個合成數字、等於qtree內使用的配額、加上FlexVol 在供應給供應給供應給供應給供應給供應給供應給供應給供應給供應給供應給供應給供應給客戶的空間。

[NOTE]
====
此總大小既不是qtree磁碟限制、也不是Volume設定的大小。它也會因您在其他qtree內的寫入活動或背景儲存效率活動而有所不同。

====
下列配額報告顯示qtree Alice1 GB的磁碟限制、qtree bob 2 GB的磁碟限制、qtree project1的磁碟限制為無上限：

[listing]
----
C1_vsim1::> quota report -vserver vs0
Vserver: vs0
                                    ----Disk----  ----Files-----   Quota
Volume   Tree      Type    ID        Used  Limit    Used   Limit   Specifier
-------  --------  ------  -------  -----  -----  ------  ------   ---------
vol2     alice     tree    1
                                  502.0MB    1GB       2       -   alice
vol2     bob       tree    2
                                   1003MB    2GB       2       -   bob
vol2     project1  tree    3
                                  200.8MB      -       2       -   project1
vol2               tree    *           0B      -       0       -   *
4 entries were displayed.
----
在以下範例中、qtree Alices和bob上的「df」命令輸出會報告與配額報告相同的已用空間、以及與磁碟限制相同的總大小（以1M區塊為準）。這是因為qtree Aliceand bob的配額規則具有已定義的磁碟限制、而Volume可用空間（1211 MB）大於qtree Alice（523 MB）和qtree bob（1045 MB）的剩餘樹狀配額空間。

[listing]
----
linux-client1 [~]$ df -m /mnt/vol2/alice
Filesystem          1M-blocks  Used Available Use% Mounted on
172.21.76.153:/vol2      1024   502       523  50% /mnt/vol2

linux-client1 [~]$ df -m /mnt/vol2/bob
Filesystem          1M-blocks  Used Available Use% Mounted on
172.21.76.153:/vol2      2048  1004      1045  50% /mnt/vol2
----
在以下範例中、qtree project1上的「df」命令輸出會報告與配額報告相同的已用空間、 但總大小是透過將整個磁碟區（1211 MB）中的可用空間新增至qtree project1（201 MB）的配額使用量、以提供總計1412 MB的空間來加以整合。這是因為qtree project1的配額規則沒有磁碟限制。

[listing]
----
linux-client1 [~]$ df -m /mnt/vol2/project1
Filesystem          1M-blocks  Used Available Use% Mounted on
172.21.76.153:/vol2      1412   201      1211  15% /mnt/vol2
----
[NOTE]
====
以下範例顯示整個Volume上的「df」命令輸出如何報告與project1相同的可用空間。

[listing]
----
linux-client1 [~]$ df -m /mnt/vol2
Filesystem          1M-blocks  Used Available Use% Mounted on
172.21.76.153:/vol2      2919  1709      1211  59% /mnt/vol2
----
====