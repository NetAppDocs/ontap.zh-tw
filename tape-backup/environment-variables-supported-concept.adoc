---
permalink: tape-backup/environment-variables-supported-concept.html 
sidebar: sidebar 
keywords: environment, variables, ontap, ndmp, restore, operation, backup, default, value, dump, smtape 
summary: 環境變數用於在啟用NDMP的備份應用程式與儲存系統之間、傳達備份或還原作業的相關資訊。支援具有相關預設值的環境變數。ONTAP不過、您可以手動修改這些預設值。 
---
= 支援的環境變數ONTAP
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
環境變數用於在啟用NDMP的備份應用程式與儲存系統之間、傳達備份或還原作業的相關資訊。支援具有相關預設值的環境變數。ONTAP不過、您可以手動修改這些預設值。

如果您手動修改備份應用程式所設定的值、應用程式的行為可能無法預測。這是因為備份或還原作業可能無法執行備份應用程式所期望的作業。但在某些情況下、審慎的修改可能有助於找出或解決問題。

下表列出傾印和SMTape常見的環境變數、以及僅支援傾印和SMTape的變數。這些表格也說明ONTAP 如何使用支援的環境變數：

[NOTE]
====
在大多數情況下，具有該值的變數（Y）也接受T和N。

====


== 轉儲和SMTape支援的環境變數

|===
| 環境變數 | 有效值 | 預設 | 說明 


 a| 
偵錯
 a| 
「Y」或「N」
 a| 
N
 a| 
指定列印偵錯資訊。



 a| 
檔案系統
 a| 
《標準化》
 a| 
無
 a| 
指定要備份之資料的根目錄路徑名稱。



 a| 
NDMP版本
 a| 
「僅限回轉動」
 a| 
無
 a| 
您不應該修改NDMP版本變數。透過備份作業建立的NDMP版本變數會傳回NDMP版本。

在備份期間、將NDMP版本變數設定為供內部使用、並將其傳遞至備份應用程式以供參考。ONTAPNDMP工作階段的NDMP版本並未使用此變數設定。



 a| 
PathName_分隔 符號
 a| 
「RE迴 轉值」
 a| 
無
 a| 
指定路徑名稱分隔符號字元。

此字元取決於要備份的檔案系統。對於這個變數、會指派字元「'/'」ONTAP 。NDMP伺服器會先設定此變數、再開始磁帶備份作業。



 a| 
類型
 a| 
「Dump」或「shtmtape」
 a| 
《阿甘》
 a| 
指定執行磁帶備份與還原作業所支援的備份類型。



 a| 
詳細資訊
 a| 
「Y」或「N」
 a| 
N
 a| 
在執行磁帶備份或還原作業時增加記錄訊息。

|===


== 支援傾印的環境變數

|===
| 環境變數 | 有效值 | 預設 | 說明 


 a| 
ACL_start
 a| 
「僅限回轉動」
 a| 
無
 a| 
由備份作業所建立的acl_start變數是直接存取還原或可重新啟動NDMP備份作業所使用的偏移值。

偏移值是傾印檔案中的位元組偏移值、ACL資料（傳遞V）會在備份結束時開始傳回。若要讓直接存取還原作業正確還原備份資料、則必須在開始還原作業時、將ACL_start值傳遞給還原作業。NDMP可重新啟動的備份作業會使用ACL_start值、與備份串流的非重新啟動部分開始的備份應用程式進行通訊。



 a| 
基準日期
 a| 
「0」、「-1」或「DUMP_date」值
 a| 
「-1」
 a| 
指定遞增備份的開始日期。

當設定為「-1」時、就會停用bin_date遞增說明符號。在0級備份上設定為「0」時、會啟用遞增備份。在初始備份之後、先前遞增備份中的dump日期變數值會指派給base日期變數。

這些變數是層級/更新型遞增備份的替代方案。



 a| 
直接
 a| 
「Y」或「N」
 a| 
N
 a| 
指定還原應直接快轉至檔案資料所在磁帶上的位置、而非掃描整個磁帶。

為了讓直接存取恢復正常運作、備份應用程式必須提供定位資訊。如果此變數設為「Y」、備份應用程式會指定檔案或目錄名稱及定位資訊。



 a| 
DMP_NAME
 a| 
《標準化》
 a| 
無
 a| 
指定多個子樹備份的名稱。

此變數是多個子樹狀結構備份的必要項目。



 a| 
dump日期
 a| 
「RE迴 轉值」
 a| 
無
 a| 
您不會直接變更此變數。如果將base_date變數設為「-1」以外的值、則會由備份建立。

dump日期變數的衍生方式是將32位元層級值預先置於傾印軟體所計算的32位元時間值。層級會從傳入base日期變數的最後一個層級值遞增。產生的值會做為後續遞增備份的base日期值。



 a| 
已啟用增強型_DAR
 a| 
「Y」或「N」
 a| 
N
 a| 
指定是否啟用增強的DAR功能。增強的DAR功能可支援目錄DAR和含有NT串流的檔案DAR。它可提升效能。

只有在符合下列條件時、才能在還原期間增強DAR：

* 支援增強的DAR。ONTAP
* 備份期間會啟用檔案歷程記錄（HIST=Y）。
* 「ndmpd.offset_map.enable」選項設為「on」。
* 在還原期間、已啟用增強型DAR的變數會設為「Y」。




 a| 
排除
 a| 
"Pattern_stret"
 a| 
無
 a| 
指定備份資料時排除的檔案或目錄。

排除清單是以逗號分隔的檔案或目錄名稱清單。如果檔案或目錄的名稱符合清單中的其中一個名稱、則會從備份中排除。

在排除清單中指定名稱時、適用下列規則：

* 必須使用檔案或目錄的確切名稱。
* 通配符星號（*）必須是字串的第一個或最後一個字元。
+
每個字串最多可有兩個星號。

* 檔案或目錄名稱中的逗號必須以反斜槓開頭。
* 排除清單最多可包含32個名稱。


[NOTE]
====
如果您同時將non-quota樹狀結構設定為「Y」、則指定要排除備份的檔案或目錄不會被排除。

====


 a| 
擷取
 a| 
「Y」、「N」或「E」
 a| 
N
 a| 
指定要還原備份資料集的子樹狀結構。

備份應用程式會指定要擷取的子樹狀結構名稱。如果指定的檔案符合其內容已備份的目錄、則會以遞歸方式擷取該目錄。

若要在還原期間重新命名檔案、目錄或qtree而不使用DAR、您必須將擷取環境變數設定為「E」。



 a| 
Extract（擷取ACL）
 a| 
「Y」或「N」
 a| 
「Y」
 a| 
指定在還原作業中還原備份檔案的ACL。

預設值是在還原資料時還原ACL、但DARs（DIRECT = Y）除外。



 a| 
力
 a| 
「Y」或「N」
 a| 
N
 a| 
決定還原作業是否必須檢查目的地磁碟區上的磁碟區空間和inode可用度。

將此變數設為「Y」會使還原作業跳過檢查目的地路徑上的磁碟區空間和inode可用度。

如果目的地Volume上沒有足夠的磁碟區空間或inode可用、還原作業會恢復目的地Volume空間和inode可用度所允許的資料量。當磁碟區空間或inode無法使用時、還原作業會停止。



 a| 
Hist
 a| 
「Y」或「N」
 a| 
N
 a| 
指定將檔案歷程記錄資訊傳送至備份應用程式。

大多數商業備份應用程式都將HIST變數設為「Y」。如果您想要提高備份作業的速度、或是想要疑難排解檔案歷程記錄集合的問題、可以將此變數設為「N」。

[NOTE]
====
如果備份應用程式不支援檔案歷程記錄、則不應將HIST變數設為「Y」。

====


 a| 
Ignore（忽略）_CTIME
 a| 
「Y」或「N」
 a| 
N
 a| 
指定檔案在上次遞增備份之後、只有其ctime值變更時、才會遞增備份。

有些應用程式（例如掃毒軟體）會變更inode內檔案的ctime值、即使檔案或其屬性尚未變更。因此、遞增備份可能會備份尚未變更的檔案。只有在遞增備份佔用不可接受的時間或空間量（因為ctime值已修改）時、才應指定「ignore _CTime」變數。

[NOTE]
====
在預設情況下、「NDMP dump」命令會將「ignore _CTime」設為「假」。將其設為「true」可能會導致下列資料遺失：

. 如果將Volume層級遞增的「ndmpcopy」設為「ignore _CTime」、則會刪除檔案、這些檔案會在來源的qtree之間移動。
. 如果在磁碟區層級遞增傾印期間將「ignore _CTIME」設定為true、則會刪除檔案、這些檔案會在遞增還原期間在來源的qtree之間移動。


若要避免此問題、在磁碟區層級「NDMP傾印」或「ndmpcopy」期間、「ignore _CTime」必須設為假。

====


 a| 
ignore qtree
 a| 
「Y」或「N」
 a| 
N
 a| 
指定還原作業不會從備份的qtree還原qtree資訊。



 a| 
層級
 a| 
"0'-'31"
 a| 
0
 a| 
指定備份層級。

層級0會複製整個資料集。遞增備份層級（以0以上的值指定）、複製自上次遞增備份以來的所有檔案（新增或修改的）。例如、層級1會自層級0備份後備份新的或修改過的檔案、層級2會備份自層級1備份以來的新檔案或修改過的檔案、依此類推。



 a| 
清單
 a| 
「Y」或「N」
 a| 
N
 a| 
列出備份的檔案名稱和inode編號、而不實際還原資料。



 a| 
list_qtree
 a| 
「Y」或「N」
 a| 
N
 a| 
列出備份的qtree、但不實際還原資料。



 a| 
多重樹狀結構名稱
 a| 
《標準化》
 a| 
無
 a| 
指定備份是多個子樹狀結構備份。

字串中會指定多個子樹狀結構、此字串是以新行分隔、以null終止的子樹狀結構名稱清單。子樹是以與其一般根目錄相關的路徑名稱來指定、必須將其指定為清單的最後一個元素。

如果您使用此變數、也必須使用DMP_name變數。



 a| 
NDMP、UNICODE、全高
 a| 
「Y」或「N」
 a| 
N
 a| 
指定除了檔案歷程記錄資訊中檔案的NFS名稱之外、還要包含一個統一碼名稱。

大多數備份應用程式不會使用此選項、除非備份應用程式是設計來接收這些額外的檔案名稱、否則不應設定此選項。也必須設定HIST變數。



 a| 
否_ACLS
 a| 
「Y」或「N」
 a| 
N
 a| 
指定在備份資料時、不得複製ACL。



 a| 
非配額樹狀結構
 a| 
「Y」或「N」
 a| 
N
 a| 
指定在備份資料時、必須忽略qtree中的檔案和目錄。

當設定為「Y」時、不會備份檔案系統變數所指定之資料集中qtree中的項目。只有檔案系統變數指定整個Volume時、此變數才會生效。非配額樹狀結構變數僅適用於層級0備份、如果指定了多重樹狀結構名稱變數、則無法運作。

[NOTE]
====
如果您同時將non-quota樹狀結構設定為「Y」、則指定要排除備份的檔案或目錄不會被排除。

====


 a| 
NOWRITE
 a| 
「Y」或「N」
 a| 
N
 a| 
指定還原作業不得將資料寫入磁碟。

此變數用於偵錯。



 a| 
循環
 a| 
「Y」或「N」
 a| 
「Y」
 a| 
指定展開DAR還原期間的目錄項目。

此外、還必須啟用DIRECT和增強型DAR環境變數（設為「Y」）。如果停用循環變數（設定為「N」）、則只有原始來源路徑中所有目錄的權限和ACL會從磁帶還原、而非從目錄內容還原。如果將循環變數設為「N」或recover_full路徑變數設為「Y」、則恢復路徑必須以原始路徑結尾。

[NOTE]
====
如果停用循環變數、且有多個恢復路徑、則所有恢復路徑都必須包含在恢復路徑中最長的路徑內。否則會顯示錯誤訊息。

====
例如、下列是有效的還原路徑、因為所有的還原路徑都位於「foo/dir1/deepdir/myfile」內：

* /foo'
* /foo/dir
* /foo/dir1/deepdir'
* /foo/dir1/deepdir/myfile'


下列是無效的還原路徑：

* /foo'
* /foo/dir
* /foo/dir1/myfile'
* /foo/dir2'
* /foo/dir2/myfile'




 a| 
recover_full路徑
 a| 
「Y」或「N」
 a| 
N
 a| 
指定完整還原路徑在DAR之後將恢復其權限和ACL。

必須同時啟用DIRECT和增強型DAR（設為「Y」）。如果recover_full路徑設定為「Y」、則恢復路徑必須以原始路徑結尾。如果目的地磁碟區上已存在目錄、則其權限和ACL將不會從磁帶還原。



 a| 
更新
 a| 
「Y」或「N」
 a| 
「Y」
 a| 
更新中繼資料資訊、以啟用層級式遞增備份。

|===


== SMTape支援的環境變數

|===
| 環境變數 | 有效值 | 預設 | 說明 


 a| 
基準日期
 a| 
《DUMP_date》
 a| 
「-1」
 a| 
指定遞增備份的開始日期。

「base _date」是參考Snapshot識別碼的字串表示。SMTape使用「base _date」字串來尋找參考Snapshot複本。

基準備份不需要使用base _date。對於遞增備份、先前基準備份或遞增備份的「DUMP_date」變數值會指派給「base _date」變數。

備份應用程式會從先前的SMTape基準或遞增備份指派「DUMP_date」值。



 a| 
dump日期
 a| 
「RE迴 轉值」
 a| 
無
 a| 
SMTape備份結束時、dump日期會包含字串識別碼、用以識別用於該備份的Snapshot複本。此Snapshot複本可作為後續遞增備份的參考Snapshot複本。

dump日期的結果值將用作後續遞增備份的base日期值。



 a| 
SMTAPE_backup_Set_ID
 a| 
《標準化》
 a| 
無
 a| 
識別與基準備份相關的遞增備份順序。

備份集ID是在基礎備份期間產生的128位元唯一ID。備份應用程式會在遞增備份期間、將此ID指派為「MTAPE_backup_Set_ID」變數的輸入。



 a| 
SMTAPE_snapshot名稱
 a| 
Volume中可用的任何有效Snapshot複本
 a| 
「無效」
 a| 
當SMTAPE_snapshot名稱變數設定為Snapshot複本時、該Snapshot複本及其舊的Snapshot複本會備份到磁帶。

對於遞增備份、此變數會指定遞增的Snapshot複本。by_date變數提供基礎Snapshot複本。



 a| 
SMTAPE_DELETE快照
 a| 
「Y」或「N」
 a| 
N
 a| 
對於SMTAPE_DELETE快照變數設為「Y」時、SMTAPE_DELETE自動建立的Snapshot複本、則在備份作業完成後、SMTAPE_DELETE會刪除此Snapshot複本。但是、由備份應用程式建立的Snapshot複本將不會刪除。



 a| 
SMTAPE_中斷 鏡射
 a| 
「Y」或「N」
 a| 
N
 a| 
當SMTAPE_中斷 鏡射變數設定為「Y」時、成功還原後、類型「DP」的磁碟區會變更為「RW」磁碟區。

|===