---
permalink: san-admin/configure-svm-nvme-task.html 
sidebar: sidebar 
keywords: configure, svm, nvme 
summary: 如果您要在節點上使用NVMe傳輸協定、則必須針對NVMe專門設定SVM。 
---
= 設定NVMe的儲存VM
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果您要在節點上使用NVMe傳輸協定、則必須針對NVMe專門設定SVM。

.您需要的產品
您的FC或乙太網路介面卡必須支援NVMe。支援的介面卡列於 https://hwu.netapp.com["NetApp Hardware Universe"^]。

.步驟
[role="tabbed-block"]
====
.系統管理員
--
使用ONTAP 「支援NVMe的儲存虛擬機器」（9.7及更新版本）。

[cols="2"]
|===
| 在新的儲存VM上設定NVMe | 在現有儲存VM上設定NVMe 


 a| 
. 在System Manager中、按一下* Storage > Storage VM*、然後按一下* Add*。
. 輸入儲存VM的名稱。
. 選擇* NVMe *作為*存取傳輸協定*。
. 選取*啟用NVMe/FC*或*啟用NVMe/TCP*和*儲存*。

 a| 
. 在System Manager中、按一下* Storage > Storage VM*。
. 按一下您要設定的儲存VM。
. 按一下*設定*索引標籤、然後按一下 image:icon_gear.gif["設定圖示"] 在NVMe傳輸協定旁。
. 選取*啟用NVMe/FC*或*啟用NVMe/TCP*和*儲存*。


|===
--
.CLI
--
使用ONTAP 支援NVMe的CLI設定儲存VM。

. 如果您不想使用現有的SVM、請建立一個：
+
`vserver create -vserver _SVM_name_`

+
.. 驗證是否已建立SVM：
+
`vserver show`



. 請確認叢集中已安裝支援NVMe或TCP的介面卡：
+
NVMe ： `network fcp adapter show -data-protocols-supported fc-nvme`

+
對於 TCP ： `network port show`

. 如果您執行ONTAP 的是SVM 9.7或更早版本、請移除SVM的所有傳輸協定：
+
`vserver remove-protocols -vserver _SVM_name_ -protocols iscsi,fcp,nfs,cifs,ndmp`

+
從ONTAP 功能支援的9.8開始、新增NVMe時不需要移除其他傳輸協定。

. 將NVMe傳輸協定新增至SVM：
+
`vserver add-protocols -vserver _SVM_name_ -protocols nvme`

. 如果您執行ONTAP 的是SVM上的支援版本、請確認NVMe是SVM上唯一允許的傳輸協定：
+
`vserver show -vserver _SVM_name_ -fields allowed-protocols`

+
NVMe 應該是唯一顯示在下的傳輸協定 `allowed protocols` 欄位。

. 建立NVMe服務：
+
`vserver nvme create -vserver _SVM_name_`

. 驗證NVMe服務是否已建立：
+
`vserver nvme show -vserver _SVM_name_`

+
。 `Administrative Status` SVM 的清單應為 `up`。

. 建立NVMe / FC LIF：
+
[cols="3*"]
|===
| 版本ONTAP | 適用的傳輸協定 | 命令 


 a| 
不含更新版本ONTAP
 a| 
FC
 a| 
`network interface create -vserver SVM_name -lif lif_name -role data -data-protocol fc-nvme -home-node home_node -home-port home_port`



 a| 
零點9.10.1 ONTAP
 a| 
FC或TCP
 a| 
`network interface create -vserver SVM_name -lif lif_name -service-policy {default-data-nvme-tcp | default-data-nvme-fc} -home-node home_node -home-port home_port -status admin up -failover-policy disabled -firewall-policy data -auto-revert false -failover-group failover_group -is-dns-update-enabled false`

|===
. 在HA合作夥伴節點上建立NVMe / FC LIF：
+
[cols="3*"]
|===
| 版本ONTAP | 適用的傳輸協定 | 命令 


 a| 
不含更新版本ONTAP
 a| 
FC
 a| 
`network interface create -vserver _SVM_name_ -lif _lif_name_ -role data -data-protocol fc-nvme -home-node _home_node_ -home-port _home_port_`



 a| 
更新版本ONTAP
 a| 
FC或TCP
 a| 
`network interface create -vserver SVM_name -lif lif_name -service-policy {default-data-nvme-tcp | default-data-nvme-fc} -home-node home_node -home-port home_port -status admin up -failover-policy disabled -firewall-policy data -auto-revert false -failover-group failover_group -is-dns-update-enabled false`

|===
. 確認已建立NVMe / FC LIF：
+
`network interface show -vserver _SVM_name_`

. 在LIF所在的同一個節點上建立Volume：
+
`vol create -vserver _SVM_name_ -volume _vol_name_ -aggregate _aggregate_name_ -size _volume_size_`

+
如果顯示有關自動效率原則的警告訊息、則可以安全地忽略該訊息。



--
====